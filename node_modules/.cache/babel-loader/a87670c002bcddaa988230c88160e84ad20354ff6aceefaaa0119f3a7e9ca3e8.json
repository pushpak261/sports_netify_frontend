{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useLocation}from\"react-router-dom\";import ProductList from\"../common/ProductList\";import Pagination from\"../common/Pagination\";import ApiService from\"../../service/ApiService\";import\"../../style/homePage.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const HomePage=()=>{const location=useLocation();const[products,setProducts]=useState([]);const[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(0);const[error,setError]=useState(null);const[loading,setLoading]=useState(false);const itemsPerPage=10;useEffect(()=>{const fetchProducts=async()=>{setLoading(true);try{let allProducts=[];const queryParams=new URLSearchParams(location.search);const searchItem=queryParams.get(\"search\");if(searchItem){const response=await ApiService.searchProducts(searchItem);allProducts=response.productList||[];setCurrentPage(1);}else{const response=await ApiService.getAllProducts();allProducts=response.productList||[];}// Ensure all images have correct URLs\nallProducts=allProducts.map(product=>{var _product$imageUrl;return{...product,imageUrl:(_product$imageUrl=product.imageUrl)!==null&&_product$imageUrl!==void 0&&_product$imageUrl.startsWith(\"http\")?product.imageUrl:`http://localhost:2424/uploads/${product.imageUrl}`};});setTotalPages(Math.ceil(allProducts.length/itemsPerPage));setProducts(allProducts.slice((currentPage-1)*itemsPerPage,currentPage*itemsPerPage));}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message||\"Unable to fetch products\");}finally{setLoading(false);}};fetchProducts();},[location.search,currentPage]);return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:loading?/*#__PURE__*/_jsx(\"p\",{className:\"loading-message\",children:\"Loading products...\"}):error?/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(ProductList,{products:products}),/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,totalPages:totalPages,onPageChange:page=>setCurrentPage(page)})]})});};export default HomePage;","map":{"version":3,"names":["React","useEffect","useState","useLocation","ProductList","Pagination","ApiService","jsx","_jsx","jsxs","_jsxs","HomePage","location","products","setProducts","currentPage","setCurrentPage","totalPages","setTotalPages","error","setError","loading","setLoading","itemsPerPage","fetchProducts","allProducts","queryParams","URLSearchParams","search","searchItem","get","response","searchProducts","productList","getAllProducts","map","product","_product$imageUrl","imageUrl","startsWith","Math","ceil","length","slice","_error$response","_error$response$data","data","message","className","children","onPageChange","page"],"sources":["C:/Users/pushp/OneDrive/Desktop/client/src/component/pages/HomePage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport ProductList from \"../common/ProductList\";\nimport Pagination from \"../common/Pagination\";\nimport ApiService from \"../../service/ApiService\";\nimport \"../../style/homePage.css\";\n\nconst HomePage = () => {\n    const location = useLocation();\n    const [products, setProducts] = useState([]);\n    const [currentPage, setCurrentPage] = useState(1);\n    const [totalPages, setTotalPages] = useState(0);\n    const [error, setError] = useState(null);\n    const [loading, setLoading] = useState(false);\n    const itemsPerPage = 10;\n\n    useEffect(() => {\n        const fetchProducts = async () => {\n            setLoading(true);\n            try {\n                let allProducts = [];\n                const queryParams = new URLSearchParams(location.search);\n                const searchItem = queryParams.get(\"search\");\n\n                if (searchItem) {\n                    const response = await ApiService.searchProducts(searchItem);\n                    allProducts = response.productList || [];\n                    setCurrentPage(1);\n                } else {\n                    const response = await ApiService.getAllProducts();\n                    allProducts = response.productList || [];\n                }\n\n                // Ensure all images have correct URLs\n                allProducts = allProducts.map((product) => ({\n                    ...product,\n                    imageUrl: product.imageUrl?.startsWith(\"http\")\n                        ? product.imageUrl\n                        : `http://localhost:2424/uploads/${product.imageUrl}`,\n                }));\n\n                setTotalPages(Math.ceil(allProducts.length / itemsPerPage));\n                setProducts(allProducts.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage));\n            } catch (error) {\n                setError(error.response?.data?.message || error.message || \"Unable to fetch products\");\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchProducts();\n    }, [location.search, currentPage]);\n\n    return (\n        <div className=\"home\">\n            {loading ? (\n                <p className=\"loading-message\">Loading products...</p>\n            ) : error ? (\n                <p className=\"error-message\">{error}</p>\n            ) : (\n                <div>\n                    <ProductList products={products} />\n                    <Pagination\n                        currentPage={currentPage}\n                        totalPages={totalPages}\n                        onPageChange={(page) => setCurrentPage(page)}\n                    />\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default HomePage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}